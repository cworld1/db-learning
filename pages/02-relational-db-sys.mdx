# 第 2 章 关系数据库

> The simplest yet most important data model.

- Information systems deal with storage and retrieval of data 信息系统处理数据的存储和检索
- Databases represent a whole collection of elements 数据库是所有元素的集合
- Relations are sets of tuples 关系的元组集
  - suitable to represent collections of data of any size
  - can be illustrated(说明) by tables

## 关系的形式化定义

> A relation schema provides an abstract description of the tuples(元组) in a relation 关系架构提供关系中的元组的抽象描述

### 域（Domain）

域是一组具有相同数据类型的值的集合，又称为值域（用 D 表示）。例如，整数、实数和字符串的集合都是域。

域中所包含的值的个数称为域的基数（用 m 表示）。在关系中就是用域来表示属性的取值范围的。

### 笛卡儿积（Cartesian Product）

给定一组域 $D_1，D_2，…，D_n$（它们可以包含相同的元素，既可以完全不同，也可以部分或全部相同），则 $D_1，D_2，…，D_n$ 的笛卡儿积为：

$$
D_1 × D_2 × … × D_n = \{(d_1，d_2，…，d_n) | d_i ∈ D_i，i=1, 2, …, n\}
$$

由定义可以看出，笛卡儿积也是一个集合，**一个二维表**。其中：

1. 每一个元素 $(d1，d2，… ，dn)$ 中的每一个值 $d_i$ 叫做一个分量（Component），分量来自相应的域（$d_i ∈ D_i$）。
2. 每一个元素 $(d1，d2，… ，dn)$ 叫做一个 n 元组（n-Tuple），简称元组（Tuple）。但元组是有序的，相同分量 $d_i$ 的不同排序所构成的元组不同。如，以下三个元组是不同的，$(1，2，3) ≠ (2，3，1) ≠ (1，3，2)$。
3. 若 $D_i (i=1，2，… ，n)$ 为有限集，$D_i$ 中的集合元素个数称为 $D_i$ 的基数，用 $m_i (i=1，2，… ，n)$ 表示，则笛卡儿积 $D_1×D_2×…×D_n$ 的基数 M［即元组 $(d1，d2，…，dn)$ 的个数］为所有域的基数的累乘之积，即 $M = ∏^n_{i=1} m_i$ 。

### 关系（Relation）

笛卡儿积 $D_1×D_2×…×D_n$ 的任一子集称为定义在域 $D_1，D_2，…，D_n$ 上的 n 元关系（Relation），可用 $R(D_1，D_2，…，D_n)$ 表示。其中，R 表示关系的名字，n 是关系的目或度（Degree）。

1. 在关系 R 中，当 $n=1$ 时，称为单元关系。当 $n=2$ 时，称为 二元关系，以此类推。

2. 关系中的每个元素是关系中的元组，通常用 t 表示，关系中元组个数是关系的基数。

   > 如果一个关系的元组个数是无限的，则称为无限关系；如果一个关系的元组个数是有限的，则称为有限关系。由于计算机存储系统的限制，我们一般不去处理无限关系，而只考虑有限关系。

3. 由于关系是笛卡儿积的子集，因此，也可以把关系看成一个二维表。其中：

   - 表的框架由域 $D_i (i=1，2，… ，n)$ 构成，即表的每一列对应一个域；
   - 表的每一行对应一个元组；
   - 由于不同域（列）的取值可以相同，为了加以区别，必须对每个域（列）起一个名字，称为属性（Attribute），n 元关系必有 n 个属性，属性的名字唯一；属性的取值范围称为值域，等价于对应域 $D_i (i=1，2，… ，n)$ 的取值范围；
   - 具有相同关系框架的关系称为同类关系。

4. 在数学上，关系是笛卡儿积的任意子集，但在实际应用中，关系是笛卡儿积中所取的有意义的子集。

   > 定义在域 $D_1，D_2，…，D_n$ （不要求完全相异）上的关系由关系头（Heading）和关系体（Body）组成。
   >
   > - 关系头由属性名 $A_1，A_2，…，A_n$ 的集合组成，每个属性 $A_i$ 对应一个域 $D_i (i=1，2，… ，n)$。关系头（关系框架）是关系的数据结构的描述，它是固定不变的。
   > - 关系体是指关系结构中的内容或者数据，它随元组的插入、删除或修改而变化。

## 关系的性质

1. 列是同质的，即每一列中的分量必须来自同一个域，必须是同一类型的数据。

2. 不同的属性可来自同一个域，但不同的属性必须有不同的名字。

3. 列的顺序可以任意交换。但交换时，应连同属性名一起交换，否则将得到不同的关系。

4. 关系中元组的顺序（即行序）可任意，在一个关系中可以任意交换两行的次序。因为关系是以元组为元素的集合，而集合中的元素是无序的，所以作为集合元素的元组也是无序的。

   > 根据关系的这个性质，可以改变元组的顺序使其具有某种排序，然后按照顺序查询数据，这样可以提高查询速度，如按照学号对元组进行排序等。

5. 关系中不允许出现相同的元组。因为数学上集合中没有相同的元素，而关系是元组的集合，所以作为集合元素的元组应该是唯一的。
6. 关系中每一分量必须是不可分的数据项，或者说所有属性值都是原子的，即是一个确定的值，而不是值的集合。属性值可以为空值，表示“未知”或“不可使用”，但不可“表中有表”。满足此条件的关系称为规范化关系，否则称为非规范化关系。

Superkrey(超码)：A superkey over a relation schema(关系模式) R is a ﬁnite subset K ⊆ R of R. An R -relation r is said to satisfy the superkey K over R if every pair of distinct tuples $t_1, t_2 ∈ r$ deviates on at least one attribute of K, that is, $t_1(A) \ne  t_2 (A)$ for some $A ∈ K$.

## 关系的码与关系的完整性

待补充
